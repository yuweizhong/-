<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> ReadyForBAT---UI · YuWeizhong</title><meta name="description" content="ReadyForBAT---UI - YuWeizhong"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/yu.github.io/favicon.png"><link rel="stylesheet" href="/yu.github.io/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yuweizhong.github.io/yu.github.io/atom.xml" title="YuWeizhong"></head><body><div class="wrap"><header><a href="/yu.github.io/" class="logo-link"><img src="/yu.github.io/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/yu.github.io/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/yu.github.io/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/u/3537156417" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/yuweizhong" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/yu.github.io/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">ReadyForBAT---UI</h1><div class="post-info">2018年10月10日</div><div class="post-content"><h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><ol>
<li>App生命周期<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&#123;&#125;</div><div class="line">                            </div><div class="line">- (void)applicationWillResignActive:(UIApplication *)application&#123;&#125;</div><div class="line"></div><div class="line">- (void)applicationDidEnterBackground:(UIApplication *)application&#123;&#125;</div><div class="line"></div><div class="line">- (void)applicationWillEnterForeground:(UIApplication *)application&#123;&#125;</div><div class="line"></div><div class="line">- (void)applicationDidBecomeActive:(UIApplication *)application&#123;&#125;</div><div class="line"></div><div class="line">- (void)applicationWillTerminate:(UIApplication *)application&#123;&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><strong>首次启动程序</strong><br>didFinishLaunchingWithOptions<br>DidBecomeActive<br><strong>从前台到后台</strong><br>WillResignActive<br>DidEnterBackground<br><strong>从后台到前台</strong><br>WillEnterForeground<br>DidBecomeActive</p>
<ol>
<li>UIViewController生命周期<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">//非storyboard和xib创建执行初始化操作走该方法</div><div class="line">- (instancetype)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil &#123;&#125;</div><div class="line"></div><div class="line">//storyboard和xib创建执行初始化操作走该方法</div><div class="line">- (instancetype)initWithCoder:(NSCoder *)aDecoder &#123;&#125;</div><div class="line"></div><div class="line">//storyboard和xib加载完成</div><div class="line">- (void)awakeFromNib&#123;&#125;</div><div class="line"></div><div class="line">//加载视图 UIViewController对象的view属性被访问到且为空的时候调用，一般由系统调用，用于自定义控制器的view ，[super loadView]默认会创建一个空白的UIView，所以重写方法时不要调用父类方法，避免不必要的开销</div><div class="line">- (void)loadView&#123;&#125;</div><div class="line"></div><div class="line">//view载入内存中，可以进行一些初始化操作</div><div class="line">- (void)viewDidLoad&#123;&#125;</div><div class="line"></div><div class="line">//view即将展现</div><div class="line">- (void)viewWillAppear&#123;&#125;</div><div class="line"></div><div class="line">// view 即将布局Subviews</div><div class="line">- (void)viewWillLayoutSubviews &#123;&#125; </div><div class="line"></div><div class="line">// view 已经布局 Subviews </div><div class="line">- (void)viewDidLayoutSubviews &#123;&#125;</div><div class="line"></div><div class="line">//view显示</div><div class="line">- (void)viewDidAppear&#123;&#125;</div><div class="line"></div><div class="line">//view即将消失</div><div class="line">- (void)viewWillDisAppear&#123;&#125;</div><div class="line"></div><div class="line">//view消失</div><div class="line">- (void)viewDidDisAppear&#123;&#125;</div><div class="line"></div><div class="line">//出现内存警告</div><div class="line">- (void)didReceiveMemoryWarning&#123;&#125;</div><div class="line"></div><div class="line">//销毁</div><div class="line">- (void)dealloc</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="事件传递和响应机制"><a href="#事件传递和响应机制" class="headerlink" title="事件传递和响应机制"></a>事件传递和响应机制</h2><p><strong>事件的产生</strong><br>发生触摸事件后，系统会将该事件加入到一个由UIApplication管理的事件队列中,根据队列的特点(FIFO)先产生的事件先处理;</p>
<p><strong>事件的传递</strong></p>
<ul>
<li style="list-style: none"><input type="checkbox"> 事件是从父控件传递到子控件，由UIApplication -&gt;UIWindow -&gt; View</li>
</ul>
<ol>
<li>首先判断主窗口（keyWindow）自己是否能接受触摸事件</li>
<li>判断触摸点是否在自己身上</li>
<li>子控件数组中从后往前遍历子控件，重复前面的两个步骤（所谓从后往前遍历子控件，就是首先查找子控件数组中最后一个元素，然后执行1、2步骤）</li>
<li>view，比如叫做fitView，那么会把这个事件交给这个fitView，再遍历这个fitView的子控件，直至没有更合适的view为止。</li>
<li>如果没有符合条件的子控件，那么就认为自己最合适处理这个事件，也就是自己是最合适的view。</li>
</ol>
<p><strong>事件的响应</strong></p>
<ol>
<li>首先判断initial view能否处理这个事件，如果不能则会将事件传递给其上级视图（inital view的superView）；</li>
<li>如果上级视图仍然无法处理则会继续往上传递；一直传递到视图控制器view controller，首先判断视图控制器的根视图view是否能处理此事件；如果不能则接着判断该视图控制器能否处理此事件，如果还是不能则继续向上传 递；（对于第二个图视图控制器本身还在另一个视图控制器中，则继续交给父视图控制器的根视图，如果根视图不能处理则交给父视图控制器处理）；一直到 window，如果window还是不能处理此事件则继续交给application处理，如果最后application还是不能处理此事件则将其丢弃</li>
</ol>
<p>可见事件的传递和事件的响应顺序正好是相反的 一个是由父视图向下传递，一个是向上传递。</p>
<blockquote>
<p>hitTest:withEvent:方法—事件传递工程中 通过调用子控件的hitTest:withEvent:方法来判断是否由最合适的view来响应事件。所以可以通过重写在父控件的hitTest:withEvent:中返回子控件作为最合适的view！来达到手动控制拦截的目的</p>
<p>pointInside:withEvent:方法判断点在不在当前view上（方法调用者的坐标系上）如果返回YES，代表点在方法调用者的坐标系上;返回NO代表点不在方法调用者的坐标系上，那么方法调用者也就不能处理事件。</p>
</blockquote>
<p>参考 <a href="https://www.jianshu.com/p/2e074db792ba" target="_blank" rel="external">https://www.jianshu.com/p/2e074db792ba</a></p>
<h2 id="UIView和-CALayer"><a href="#UIView和-CALayer" class="headerlink" title="UIView和 CALayer"></a>UIView和 CALayer</h2><h2 id="UITableView"><a href="#UITableView" class="headerlink" title="UITableView"></a>UITableView</h2><ol>
<li>a.将cell及它的子控件设置为不透明的。b.尽量少用或不用透明图层。c.减少子控件的数量。d.尽量少用addView给Cell动态添加View，可以初始化时就添加，然后通过hide来控制是否显示。e如果Cell内现实的内容来自web,使用异步加载,缓存请求结果这个在我的《iOS多图下载案例》系列文章中有具体讲解原理，这个采用sdwebimage这个第三方框架即可。这几个都是通过轻量级cell来对tableview进行优化。</li>
<li>正确使用reuseIdentifier来重用Cell。</li>
<li>提前计算并缓存好高度（布局），因为heightForRowAtIndexPath:是调用最频繁的方法。</li>
<li>滑动的UITableView时，按需加载对应的内容</li>
</ol>
</div></article></div></main><footer><div class="paginator"><a href="/yu.github.io/2018/09/28/iOS设备旋转及页面横竖屏/" class="next">NEXT</a></div><div class="copyright"><p>© 2017 - 2018 <a href="https://yuweizhong.github.io/yu.github.io">YuWeizhong</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>